<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="UTF-8">
<title>German Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Ljep≈°i font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
/* feedback colors */
button.correct { background: linear-gradient(135deg, #16a34a, #22c55e) !important; }
button.wrong { background: linear-gradient(135deg, #dc2626, #ef4444) !important; }

body {
    font-family: 'Inter', Arial, sans-serif;
    background: linear-gradient(135deg, #eef2ff, #f8fafc);
    padding: 20px;
    transition: background 0.3s, color 0.3s;
}

.box {
    max-width: 620px;
    background: white;
    padding: 24px;
    margin: auto;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    position: relative;
}

h1 {
    margin-top: 5px;
    font-weight: 700;
}

/* GUMBI */
button {
    padding: 12px;
    margin: 6px 0;
    width: 100%;
    font-size: 16px;
    cursor: pointer;
    border: none;
    border-radius: 10px;
    background: linear-gradient(135deg, #4f46e5, #6366f1);
    color: white;
    transition: all 0.2s;
    font-weight: 600;
}

button:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 12px rgba(79,70,229,0.25);
}

.secondary {
    background: #e5e7eb;
    color: #111;
}

/* Progress */
.progress-wrapper {
    margin: 10px 0 18px 0;
}

.progress-bar {
    height: 8px;
    background: #e5e7eb;
    border-radius: 10px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #22c55e, #4ade80);
    width: 0%;
    transition: width 0.3s;
}

.progress-text {
    font-size: 14px;
    margin-top: 6px;
    color: #555;
}

/* Dark mode ‚Äì diskretni gumb */
.dark-toggle {
    position: absolute;
    top: 12px;
    right: 12px;
    width: auto;
    padding: 6px 10px;
    font-size: 12px;
    background: #111;
}

body.dark-mode {
    background: #0f172a;
    color: #f1f5f9;
}

body.dark-mode .box {
    background: #111827;
    color: #f1f5f9;
}

body.dark-mode .progress-bar {
    background: #1f2937;
}

@media (max-width: 500px) {
    .box { padding: 16px; }
    button { font-size: 15px; }
}
</style>
</head>
<body>

<div class="box">
    <button id="themeBtn" class="dark-toggle secondary" onclick="toggleDarkMode()" title="Toggle dark mode">üåô</button>

    <h1>German Articles Trainer</h1>

    <div class="progress-wrapper">
        <div class="progress-bar">
            <div id="progress" class="progress-fill"></div>
        </div>
        <div id="progressText" class="progress-text"></div>
    </div>

    <div id="content">Loading...</div>
</div>

<script>
let words = [];
let selected = [];
let index = 0;
let quizIndex = 0;
let correct = 0;
let wrongAnswers = [];
let QUIZ_SIZE = 10;

fetch("Woerter.txt")
  .then(r => r.text())
  .then(text => {
      const lines = text.split("\n");
      words = lines.map(l => {
          const p = l.trim().split(/\s+/);
          return { adj: p[0], noun: p[1], article: p[2] };
      }).filter(w => w.noun);

      QUIZ_SIZE = Math.min(10, words.length);
      selected = shuffle(words).slice(0, QUIZ_SIZE);
      showPair();
  })
  .catch(() => {
      document.getElementById("content").innerText =
          "Error loading Woerter.txt";
  });

function updateProgress(current) {
    const percent = Math.round((current / QUIZ_SIZE) * 100);
    document.getElementById("progress").style.width = percent + "%";
    document.getElementById("progressText").innerText =
        `Question ${Math.min(current + 1, QUIZ_SIZE)} / ${QUIZ_SIZE}`;
}

function showPair() {
    updateProgress(index);

    if (index >= QUIZ_SIZE) return startQuiz();
    const w = selected[index];

    document.getElementById("content").innerHTML = `
        <h2>${w.adj} ${w.noun}</h2>
        <button onclick="nextPair()">Next</button>
    `;
}

function nextPair() {
    index++;
    showPair();
}

function startQuiz() {
    quizIndex = 0;
    correct = 0;
    wrongAnswers = [];
    showQuestion();
}

function showQuestion() {
    updateProgress(quizIndex);

    if (quizIndex >= QUIZ_SIZE) return showResult();
    const w = selected[quizIndex];

    document.getElementById("content").innerHTML = `
        <h2>${w.noun}</h2>
        <p>Select the correct article</p>
        <button onclick="answer('der', this)">der</button>
        <button onclick="answer('die', this)">die</button>
        <button onclick="answer('das', this)">das</button>
    `;
}

function answer(a, btn) {
    const w = selected[quizIndex];

    const correctAnswer = a === w.article;

    // visual feedback
    if (btn) {
        btn.classList.add(correctAnswer ? 'correct' : 'wrong');
    }

    if (correctAnswer) {
        correct++;
    } else {
        wrongAnswers.push(`${w.adj} ${w.noun} ‚Üí ${w.article}`);
    }

    // wait a bit so user can see color
    setTimeout(() => {
        quizIndex++;
        showQuestion();
    }, 500);
}

function showResult() {
    updateProgress(QUIZ_SIZE);

    const percent = Math.round((correct / QUIZ_SIZE) * 100);

    let wrongHtml = "";
    if (wrongAnswers.length > 0) {
        wrongHtml = "<h3>Mistakes:</h3><ul>" +
                    wrongAnswers.map(x => `<li>${x}</li>`).join("") +
                    "</ul>";
    }

    document.getElementById("content").innerHTML = `
        <h2>Rezultat: ${percent}%</h2>
        ${wrongHtml}
        <button onclick="restart()">New Quiz</button>
    `;
}

function restart() {
    index = 0;
    selected = shuffle(words).slice(0, QUIZ_SIZE);
    showPair();
}

function shuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
}

function toggleDarkMode() {
    const isDark = document.body.classList.toggle("dark-mode");
    localStorage.setItem("dark", isDark);

    // change icon
    const btn = document.getElementById("themeBtn");
    if (btn) btn.innerText = isDark ? "‚òÄÔ∏è" : "üåô";
}

if (localStorage.getItem("dark") === "true") {
    document.body.classList.add("dark-mode");
    const b = document.getElementById("themeBtn");
    if (b) b.innerText = "‚òÄÔ∏è";
}
</script>

</body>
</html>
